<div class="container">
	<app-shared-card
		cardBodyClass="d-flex flex-column justify-content-center"
	>
		<ng-template #header>
			Angular HttpClient
		</ng-template>

		<ng-template #body>
			<input
				type="text"
				class="form-control"
				placeholder="Название"
				aria-label="Название"
				[(ngModel)]="todoTitle"
			>

			<div class="d-flex mt-3">
				<button
					class="btn btn-dark"
					(click)="addTodo()"
				>
					Добавить
				</button>
				<button
					class="btn btn-secondary mx-2"
					(click)="fetchTodoCollection()"
				>
					Загрузить
				</button>
			</div>

			<p
				*ngIf="errorMsg; else todoCollectionBlock"
				class="invalid-feedback d-block mt-3 mb-0"
			>
				{{errorMsg}}
			</p>

			<ng-template #todoCollectionBlock>

				<ng-container *ngIf="!loading; else loader">
					<ng-container *ngIf="todoCollection.length; else noTodo">
						<div
							class="
								border rounded-2
								d-flex flex-md-row flex-column
								align-items-center justify-content-between
								p-3 mt-4
							"
							*ngFor="let httpItem of todoCollection"
						>
							<h3
								class="h4 mb-0"
								[class.text-decoration-line-through]="httpItem.completed"
							>
								{{httpItem.title | titlecase}}
							</h3>
							<div class="d-flex">
								<button
									class="btn btn-danger"
									(click)="removeHttp(httpItem.id)"
								>
									Удалить
								</button>
								<button
									class="btn btn-dark mx-2"
									[disabled]="httpItem.completed"
									(click)="completeTodo(httpItem.id)"
								>
									Завершить
								</button> <!--TODO не работает на добавленных постах-->
							</div>
						</div>
					</ng-container>
				</ng-container>

				<ng-template #loader>
					<div class="spinner-border text-secondary mx-auto" role="status">
						<span class="visually-hidden">Loading...</span>
					</div>
				</ng-template>

				<ng-template #noTodo>
					<img src="https://muizre.ru/_dr/2/20616899.jpg" alt="Нет контента" class="mt-3">
				</ng-template>
			</ng-template>
		</ng-template>
	</app-shared-card>
</div>
